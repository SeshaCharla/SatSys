\section{Intorduction}

Diesel engine after-treatment systems diminish the emission of harmful gases such as $NO_x$ and $CO$ from exhaust gases.
The Selective Catalytic Reduction (SCR) system chemically converts $NO_x$ into $N_2$ and $H_2O$, utilizing ammonia as a
reducing agent in the presence of a catalyst. This catalytic conversion process is regulated to decrease the levels of
ammonia in the exhaust, known as Ammonia Slip. Additionally, a catalytic reaction the Ammonia Slip Catalysis(ASC) is
also used to oxidize any excess ammonia at the end of the SCR bed. Figure-\ref{fig:exhaust_scheme} shows a schematic of
the SCR-ASC system. It is found that $No_x$-reduction capacity of the catalyst reduces with time due to hydro-thermal
aging and deposition of contaminants such as excess urea, platinum, sulfur and phosphorous \cite{jain2023diagnostics}.
The catalyst aging is a critical issue in the SCR-ASC system, as it can lead to reduction in the efficacy of conversion
and increased ammonia slip. A fault detection system that can detect the aging of the catalyst would provide better
control over the maintenance of the system and improve the overall reduction in emissions.

\begin{figure}[ht]
    \centering
    \includegraphics[width=0.45\textwidth]{./figs/1_intro/SCR-ASC_ModelReduction.png}
    \caption{Schematic of the SCR-ASC system}
    \label{fig:exhaust_scheme}
\end{figure}

Thus, modern diesel after-treatment systems, particularly those that integrate Selective Catalytic Reduction (SCR) with
Ammonia Slip Catalyst (ASC), necessitate advanced on-board diagnostics (OBD) tools for accurate assessment of SCR
degradation levels. However, the effectiveness of traditional OBD approaches for this purpose has been impeded by the
absence of model validation with real-world catalyst degradation data and the limitations imposed by existing commercial
$NO_x$ sensors' cross-sensitivity to ammonia.

Numerous studies have been conducted on modeling the SCR-ASC systems and their control \cite{yuan2015diesel}. A
prevalent modeling approach is to approximate the PDE model from the plug flow reactor assumption into a set of ODEs
using the idealization of the plug-flow reactor into a sequence of Continuously Stirred Tank Reactors (CSTRs)
(\cite{hsieh2011development}, and \cite{nova2014urea}). This discretization requires at least 2 CSTRs to capture the
system dynamics and causality, thereby increasing the model order. The single CSTR approach was first justified in
\cite{devarakonda2008adequacy} and a nonlinear model was developed using these assumptions, which was then linearized
for feedback control design (\cite{devarakonda2009model}). With this model, observers were designed to estimate the
states corresponding to the catalyst's storage (\cite{ma2017observer}, \cite{jain2020term}). A method for detecting the
catalyst's aging by observing the change in the maximum storage capacity of the catalyst, modeled as an exponential
function of temperature, was also proposed in \cite{ma2017observer}. A common theme in these studies is the resulting
non-convex, nonlinear parameter estimation problem. Moreover, these studies assume the availability of all the gaseous
states at the tail-pipe to eliminate the effects of cross-sensitivity of the $NO_x$ sensors, which is not always the
case in real-world applications. One other fundamental issue with a single cell CSTR assumption is that it results in
the causality reversal at the reaction rates as CSTR inherently assumes that the output concentrations are the same as
CSTR's accumulator concentrations \cite{charla2024reduced}.

An alternative approach to the problem would be discarding the CSTR assumption and modelling the time evolution of the
sensor signals when a "plug" or "parcel" of the exhaust gases flows through the chamber in discrete time considering the
interplay between sampling and residence time of the reactants. The catalyst saturation that is inherently considered in
the CSTR approach needs to be explicitly included as separate mode of the system. The present work developed such a
model under catalyst saturation which becomes one of the modes of the complete switched nonlinear model. Following the
model development we present the parameter estimation algorithm that estimates the parameters of the saturated catalyst
model using the real-world data whose operating mode is unknown and has additional uncertainties due to $NO_x$ sensor's
cross-sensitivity to ammonia.
